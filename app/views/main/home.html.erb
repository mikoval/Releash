<% provide(:title, "Home") %>


<div class = "container" style="display:flex; flex-flow: row wrap;  justify-content: space-around;">
    <div class= "col-lg-12 col-md-12 col-sm-12 col-xs-12 "><h1>Dashboard</h1></div>

    <div class = "col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <div class= "panel panel-default animal-list"></div>
    </div>

    <div class = "col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <div class= "panel panel-default user-list"></div>
    </div>

    <div class = "col-lg-6 col-md-6 col-sm-12 col-xs-12">
        <div class= "panel panel-default alert-list"></div>
    </div>

    <div style = "visibile:false; width: 45% "> </div>
</div>

<script>

if($(".animal-list").length > 0) {
    widgetAnimalList();
}
if($(".user-list").length > 0){
    widgetUserList();
}
if($(".alert-list").length > 0){
    widgetAlertList();
}

function widgetAnimalList(){
    $.ajax({url: "animals/query", success: function(result){
        var str = "<div class='panel-heading'> <h3 class= 'panel-title'> Animals</h3> </div>"
        str += "<div class='panel-body'> <div class='table-responsive'> <table class='table table-bordered table-hover table-striped'> <thead> <tr> <th>Name</th> <th>Primary Breed</th> <th>Secondary Breed</th> </tr> </thead>" 
        for (x in result){
    
                str += "<tr> \
                <td> <a href='/animals/profile?method=get&param=" + result[x].id + "class= 'list-group-item' >" + result[x].name + "</a></td>\
                 <td>" + result[x].primary + "</td>\
                <td>" + result[x].secondary + "</td>\
                </tr>"
        }
        str +=  " </table> </div> <div class='text-right'> <a href= animals>View all Animals</a> </div> </div>"
         $(".animal-list").each(function(){
            $(this).html( str)
         })
    }});
}

function widgetUserList(){
    $.ajax({url: "people/query", success: function(result){
        var str = "<div class='panel-heading'> <h3 class= 'panel-title'> Users</h3> </div>"
        str += "<div class='panel-body'> <div class='table-responsive'> <table class='table table-bordered table-hover table-striped'> <thead> <tr> <th>Name</th> <th>Email</th> </tr> </thead>" 

        for (x in result){
    
                str += "<tr> \
                <td> <a href='/people/profile?method=get&param=" + result[x].id + "' > " + result[x].name + "</a></td>\
                 <td>" + result[x].email + "</td>\
                </tr>"
        }
        str +=  " </table> </div> <div class='text-right'> <a href= people>View all Users</a> </div> </div>"

         $(".user-list").each(function(){
            $(this).html( str)
         })
    }});
}

function widgetAlertList(){
    $.ajax({url: "/alerts/query", success: function(result){
        var str = "<div class='panel-heading'> <h3 class= 'panel-title'> Alerts</h3> </div>"
        str += "<div class='panel-body'> <div class='table-responsive'> <table class='table table-bordered table-hover table-striped'> <thead> <tr> <th>Title</th> <th>Date</th> </tr> </thead>" 

        for (x in result){
    
                str += "<tr> \
                <td> <a> " + result[x].title + "</a></td>\
                 <td>" + result[x].date + "</td>\
                </tr>"
        }
        str +=  " </table> </div> <div class='text-right'> <a href= alerts>View all Alerts</a> </div> </div>"

         $(".alert-list").each(function(){
            $(this).html( str)
         })
    }});
}
</script>