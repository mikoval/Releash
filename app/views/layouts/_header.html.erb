<header class="navbar navbar-fixed-top navbar-inverse">
  <div class="container">
    <%= link_to "Dashboard", root_path, id: "logo" %>
    <nav>
      <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">


        <ul class="nav navbar-nav navbar-left">
           <li><%= link_to "Animals",    animals_path %></li>
          <li><%= link_to "People",   people_path %></li>
          <li><%= link_to "Alerts",   alerts_list_path%></li>
          <li style = "display: inline-block; width: 200px; white-space: nowrap;">
            <span class = 'glyphicon glyphicon-search navbar-text' style = "display: inline-block; font-size: 24px; margin-right:5px" ></span> 

            <input style = " width: 100%; vertical-align: middle; margin-top:15px" placeholder="Search" class ="search" /> 
          </li>
          <li></li>
        </ul>
        
        <ul class="nav navbar-nav navbar-right">
         <% if logged_in? %>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Account <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">

                <li> <%= link_to "Profile",  :controller => "people", :action => "profile", :param => current_user, :method => "get" %></li>
                <li><%= link_to "Settings", '#' %></li>
                <li class="divider"></li>
                <li>
                  <%= link_to "Log out", logout_path, method: "delete" %>
                </li>
              </ul>
            </li>
          <% else %>
            <li><%= link_to "Log in", login_path %></li>
          <% end %>
          
        </ul>
      </div>
    </div>
    </nav>
  </div>
<div style = "position:fixed" class = "search-result col-md-4 col-md-offset-4">
    
</div>
</header>


<script>
$(".search").on( "keyup",function(input){
  var value = $(this).val()
  //do the ajax call then update findings
   $.ajax({
    url: "/animals/search",
    data: {q: value},
    success: function(result){
        var str = " "
        str += "<table class='table search-list'>" 

        for (x in result){
                if (result[x].check == "animal") {
                  str += "<tr> \
                  <td>  <img src='"+ result[x].picture.picture.url+ "' alt='missing picture' style='width:50px;height:50px;'></td>\
                  <td> <a href='/animals/profile?method=get&param=" + result[x].id + "' onmousedown='link(event)'> " + result[x].name + " </a></td>\
                   <td>" + result[x].attribute + "</td>\
                  </tr>"
                }
                if (result[x].check == "user") {
                  str += "<tr> \
                    <td>  <img src='"+ result[x].picture.picture.url+ "' alt='missing picture' style='width:50px;height:50px;'></td>\
                    <td> <a href='/people/profile?method=get&param=" + result[x].id + "' onmousedown='link(event)'> " + result[x].name + " </a></td>\
                     <td>" + result[x].attribute + "</td>\
                    </tr>"
                }
        }
        str +=  " </table>"
         $(".search-result").each(function(){
            $(this).html( str)
         })

    }});
   $(".search").on( "blur", function(target){

       $(".search-result").each(function(){
            $(this).html( '')
         })
   } )
})
function link(e){
  $(e.target).trigger("click")
 
  window.location.href = $(e.target).attr("href"); 
}
</script>
